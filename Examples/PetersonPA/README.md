### PetersonPA
This is an example of a ProActive/GCM project. It is based on the automatically generated source code of Peterson's leader election algorithm modeled in [PetersonVCE](https://github.com/Scale-VerCors/VCEv4/tree/master/Examples/PetersonVCE#project-overview) project.

##### Project overview
In order to demonstrate execution of the Java code generated by VCEv4 from PetersonVCE project, we programmatically bind Application component generated by VCE to two other components: KeyStorage and Monitor. KeyStorage serves requestKey() method. Monitor serves IamTheLeader(int cnum) and IamNotTheLeader(int cnum) operations. KeyStorage and Monitor do not not perform any computations but only print messages to the console depending on the method invocations they receive from Application component.

The project contains:
* lib folder - contains all the libraries needed to test the project including ProActive.jar;
* Application.fractal - an ADL file of the modeled example;
* src/le package - includes the code of the modeled example generated by VCEv4;
* src/externalcomponents, Monitor.fracta, KeyStorage.fractal - external components that were not modeled in VCEv4;
* src/Main.java - the starting point of the example. It invokes the factory that constructs the components from ADL files, binds components, starts them and calls runPeterson() operation on Application component.

##### Run the project
In order to use ProActive library, add .java.policy file to your user home directory. The file should give permissions to ProActive. An example of the file contents could be:

grant {
permission java.security.AllPermission;
};

In order to run the project, run main(..) method of src/Main.java with the following VM argument: "-Dgcm.provider="org.objectweb.proactive.core.component.Fractive".

After the components were created and runPeterson() method of Application is invoked, the following output will be printed to the console:

(1) The leader is not: 3

(2) The leader is not: 4

(3) The leader is not: 2

(4) The key was requested

(5) The leader is: 1

(6) The key will be returned

The messages are printed by KeyStorage and Monitor. KeyStorage prints (5) when requestKey() is invoked and (6) just before the key is returned. Monitor prints (1-3) and (5) when IamNotTheLeader() and IamTheLeader() operations are called correspondingly. We can see that Monitor receives IamTheLeader() method invocation after the key was requested but before the key is returned by KeyStorage. This demonstrates that indeed the leader is not blocked if is does not need the result of requestKey() since the leader can still invoke IamTheLeader() operation.

 
